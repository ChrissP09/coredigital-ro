---
import brain from 'lucide-static/icons/brain.svg?raw';
import brainCircuit from 'lucide-static/icons/brain-circuit.svg?raw';
import messagesSquare from 'lucide-static/icons/messages-square.svg?raw';
import wandSparkles from 'lucide-static/icons/wand-sparkles.svg?raw';
import sendHorizontal from 'lucide-static/icons/send-horizontal.svg?raw';
import arrowUpRight from 'lucide-static/icons/arrow-up-right.svg?raw';
import lock from 'lucide-static/icons/lock.svg?raw';
import globe from 'lucide-static/icons/globe.svg?raw';
import sparkles from 'lucide-static/icons/sparkles.svg?raw';
import badgeCheck from 'lucide-static/icons/badge-check.svg?raw';
import chevronDown from 'lucide-static/icons/chevron-down.svg?raw';

const { name, class: className = '', size = 24 } = Astro.props;

const icons = {
  Brain: brain,
  BrainCircuit: brainCircuit,
  MessagesSquare: messagesSquare,
  WandSparkles: wandSparkles,
  SendHorizontal: sendHorizontal,
  ArrowUpRight: arrowUpRight,
  Lock: lock,
  Globe: globe,
  Sparkles: sparkles,
  BadgeCheck: badgeCheck,
  ChevronDown: chevronDown,
};

const raw = icons[name];
if (!raw) {
  throw new Error(`Lucide icon not found: ${name}`);
}

let svg = raw;

svg = svg.replace(/width=\"[^\"]*\"/i, `width="${size}"`);
svg = svg.replace(/height=\"[^\"]*\"/i, `height="${size}"`);

const baseStyle = 'display:inline-block;vertical-align:middle;';
if (/style=\"/i.test(svg)) {
  svg = svg.replace(/style=\"([^\"]*)\"/i, (match, style) => {
    const normalized = style.trim().replace(/;?\s*$/, ';');
    return `style="${normalized} ${baseStyle}"`;
  });
} else {
  svg = svg.replace(/<svg\b/i, `<svg style="${baseStyle}"`);
}

if (className) {
  if (/class=\"/i.test(svg)) {
    svg = svg.replace(/class=\"([^\"]*)\"/i, `class="$1 ${className}"`);
  } else {
    svg = svg.replace(/<svg\b/i, `<svg class="${className}"`);
  }
}

if (!/aria-hidden=\"/i.test(svg)) {
  svg = svg.replace(/<svg\b/i, `<svg aria-hidden="true"`);
}

if (!/focusable=\"/i.test(svg)) {
  svg = svg.replace(/<svg\b/i, `<svg focusable="false"`);
}
---

<Fragment set:html={svg} />
